\subsection{Multiplication over $\bbfGF(2^{255}-19)$}
\label{appendix:multiplication}
The following \mydsl code implements multiplications over $\bbfGF(2^{255}-19)$:
\allowdisplaybreaks[1]
{\tiny
\begin{multicols}{2}
\begin{align*}
1 &: \mathit{mulrax} \leftarrow & \mathit{x3}; \\
2 &: \mathit{mulrax} \leftarrow & \mathit{mulrax} \times 19; \\
3 &: \mathit{mulx319} \leftarrow & \mathit{mulrax}; \\
4 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y2}, \mathit{wsize}); \\
5 &: \mathit{r0} \leftarrow & \mathit{mulrax}; \\
6 &: \mathit{mulr01} \leftarrow & \mathit{mulrdx}; \\
7 &: \mathit{mulrax} \leftarrow & \mathit{x4}; \\
8 &: \mathit{mulrax} \leftarrow & \mathit{mulrax} \times 19; \\
9 &: \mathit{mulx419} \leftarrow & \mathit{mulrax}; \\
10 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y1}, \mathit{wsize}); \\
11 &: \mathit{r0} \leftarrow & \mathit{r0} + \mathit{mulrax}; \\
12 &: \concat{\mathit{carry}}{\mathit{r0}} \leftarrow & \dslcode{Split}(\mathit{r0}, \mathit{wsize}); \\
13 &: \mathit{mulr01} \leftarrow & \mathit{mulr01} + \mathit{mulrdx} + \mathit{carry}; \\
14 &: \mathit{mulrax} \leftarrow & \mathit{x0}; \\
15 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y0}, \mathit{wsize}); \\
16 &: \mathit{r0} \leftarrow & \mathit{r0} + \mathit{mulrax}; \\
17 &: \concat{\mathit{carry}}{\mathit{r0}} \leftarrow & \dslcode{Split}(\mathit{r0}, \mathit{wsize}); \\
18 &: \mathit{mulr01} \leftarrow & \mathit{mulr01} + \mathit{mulrdx} + \mathit{carry}; \\
19 &: \mathit{mulrax} \leftarrow & \mathit{x0}; \\
20 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y1}, \mathit{wsize}); \\
21 &: \mathit{r1} \leftarrow & \mathit{mulrax}; \\
22 &: \mathit{mulr11} \leftarrow & \mathit{mulrdx}; \\
23 &: \mathit{mulrax} \leftarrow & \mathit{x0}; \\
24 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y2}, \mathit{wsize}); \\
25 &: \mathit{r2} \leftarrow & \mathit{mulrax}; \\
26 &: \mathit{mulr21} \leftarrow & \mathit{mulrdx}; \\
27 &: \mathit{mulrax} \leftarrow & \mathit{x0}; \\
28 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y3}, \mathit{wsize}); \\
29 &: \mathit{r3} \leftarrow & \mathit{mulrax}; \\
30 &: \mathit{mulr31} \leftarrow & \mathit{mulrdx}; \\
31 &: \mathit{mulrax} \leftarrow & \mathit{x0}; \\
32 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y4}, \mathit{wsize}); \\
33 &: \mathit{r4} \leftarrow & \mathit{mulrax}; \\
34 &: \mathit{mulr41} \leftarrow & \mathit{mulrdx}; \\
35 &: \mathit{mulrax} \leftarrow & \mathit{x1}; \\
36 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y0}, \mathit{wsize}); \\
37 &: \mathit{r1} \leftarrow & \mathit{r1} + \mathit{mulrax}; \\
38 &: \concat{\mathit{carry}}{\mathit{r1}} \leftarrow & \dslcode{Split}(\mathit{r1}, \mathit{wsize}); \\
39 &: \mathit{mulr11} \leftarrow & \mathit{mulr11} + \mathit{mulrdx} + \mathit{carry}; \\
40 &: \mathit{mulrax} \leftarrow & \mathit{x1}; \\
41 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y1}, \mathit{wsize}); \\
42 &: \mathit{r2} \leftarrow & \mathit{r2} + \mathit{mulrax}; \\
43 &: \concat{\mathit{carry}}{\mathit{r2}} \leftarrow & \dslcode{Split}(\mathit{r2}, \mathit{wsize}); \\
44 &: \mathit{mulr21} \leftarrow & \mathit{mulr21} + \mathit{mulrdx} + \mathit{carry}; \\
45 &: \mathit{mulrax} \leftarrow & \mathit{x1}; \\
46 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y2}, \mathit{wsize}); \\
47 &: \mathit{r3} \leftarrow & \mathit{r3} + \mathit{mulrax}; \\
48 &: \concat{\mathit{carry}}{\mathit{r3}} \leftarrow & \dslcode{Split}(\mathit{r3}, \mathit{wsize}); \\
49 &: \mathit{mulr31} \leftarrow & \mathit{mulr31} + \mathit{mulrdx} + \mathit{carry}; \\
50 &: \mathit{mulrax} \leftarrow & \mathit{x1}; \\
51 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y3}, \mathit{wsize}); \\
52 &: \mathit{r4} \leftarrow & \mathit{r4} + \mathit{mulrax}; \\
53 &: \concat{\mathit{carry}}{\mathit{r4}} \leftarrow & \dslcode{Split}(\mathit{r4}, \mathit{wsize}); \\
54 &: \mathit{mulr41} \leftarrow & \mathit{mulr41} + \mathit{mulrdx} + \mathit{carry}; \\
55 &: \mathit{mulrax} \leftarrow & \mathit{x1}; \\
56 &: \mathit{mulrax} \leftarrow & \mathit{mulrax} \times 19; \\
57 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y4}, \mathit{wsize}); \\
58 &: \mathit{r0} \leftarrow & \mathit{r0} + \mathit{mulrax}; \\
59 &: \concat{\mathit{carry}}{\mathit{r0}} \leftarrow & \dslcode{Split}(\mathit{r0}, \mathit{wsize}); \\
60 &: \mathit{mulr01} \leftarrow & \mathit{mulr01} + \mathit{mulrdx} + \mathit{carry}; \\
61 &: \mathit{mulrax} \leftarrow & \mathit{x2}; \\
62 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y0}, \mathit{wsize}); \\
63 &: \mathit{r2} \leftarrow & \mathit{r2} + \mathit{mulrax}; \\
64 &: \concat{\mathit{carry}}{\mathit{r2}} \leftarrow & \dslcode{Split}(\mathit{r2}, \mathit{wsize}); \\
65 &: \mathit{mulr21} \leftarrow & \mathit{mulr21} + \mathit{mulrdx} + \mathit{carry}; \\
66 &: \mathit{mulrax} \leftarrow & \mathit{x2}; \\
67 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y1}, \mathit{wsize}); \\
68 &: \mathit{r3} \leftarrow & \mathit{r3} + \mathit{mulrax}; \\
69 &: \concat{\mathit{carry}}{\mathit{r3}} \leftarrow & \dslcode{Split}(\mathit{r3}, \mathit{wsize}); \\
70 &: \mathit{mulr31} \leftarrow & \mathit{mulr31} + \mathit{mulrdx} + \mathit{carry}; \\
71 &: \mathit{mulrax} \leftarrow & \mathit{x2}; \\
72 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y2}, \mathit{wsize}); \\
73 &: \mathit{r4} \leftarrow & \mathit{r4} + \mathit{mulrax}; \\
74 &: \concat{\mathit{carry}}{\mathit{r4}} \leftarrow & \dslcode{Split}(\mathit{r4}, \mathit{wsize}); \\
75 &: \mathit{mulr41} \leftarrow & \mathit{mulr41} + \mathit{mulrdx} + \mathit{carry}; \\
76 &: \mathit{mulrax} \leftarrow & \mathit{x2}; \\
77 &: \mathit{mulrax} \leftarrow & \mathit{mulrax} \times 19; \\
78 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y3}, \mathit{wsize}); \\
79 &: \mathit{r0} \leftarrow & \mathit{r0} + \mathit{mulrax}; \\
80 &: \concat{\mathit{carry}}{\mathit{r0}} \leftarrow & \dslcode{Split}(\mathit{r0}, \mathit{wsize}); \\
81 &: \mathit{mulr01} \leftarrow & \mathit{mulr01} + \mathit{mulrdx} + \mathit{carry}; \\
82 &: \mathit{mulrax} \leftarrow & \mathit{x2}; \\
83 &: \mathit{mulrax} \leftarrow & \mathit{mulrax} \times 19; \\
84 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y4}, \mathit{wsize}); \\
85 &: \mathit{r1} \leftarrow & \mathit{r1} + \mathit{mulrax}; \\
86 &: \concat{\mathit{carry}}{\mathit{r1}} \leftarrow & \dslcode{Split}(\mathit{r1}, \mathit{wsize}); \\
87 &: \mathit{mulr11} \leftarrow & \mathit{mulr11} + \mathit{mulrdx} + \mathit{carry}; \\
88 &: \mathit{mulrax} \leftarrow & \mathit{x3}; \\
89 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y0}, \mathit{wsize}); \\
90 &: \mathit{r3} \leftarrow & \mathit{r3} + \mathit{mulrax}; \\
91 &: \concat{\mathit{carry}}{\mathit{r3}} \leftarrow & \dslcode{Split}(\mathit{r3}, \mathit{wsize}); \\
92 &: \mathit{mulr31} \leftarrow & \mathit{mulr31} + \mathit{mulrdx} + \mathit{carry}; \\
93 &: \mathit{mulrax} \leftarrow & \mathit{x3}; \\
94 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y1}, \mathit{wsize}); \\
95 &: \mathit{r4} \leftarrow & \mathit{r4} + \mathit{mulrax}; \\
96 &: \concat{\mathit{carry}}{\mathit{r4}} \leftarrow & \dslcode{Split}(\mathit{r4}, \mathit{wsize}); \\
97 &: \mathit{mulr41} \leftarrow & \mathit{mulr41} + \mathit{mulrdx} + \mathit{carry}; \\
98 &: \mathit{mulrax} \leftarrow & \mathit{mulx319}; \\
99 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y3}, \mathit{wsize}); \\
100 &: \mathit{r1} \leftarrow & \mathit{r1} + \mathit{mulrax}; \\
101 &: \concat{\mathit{carry}}{\mathit{r1}} \leftarrow & \dslcode{Split}(\mathit{r1}, \mathit{wsize}); \\
102 &: \mathit{mulr11} \leftarrow & \mathit{mulr11} + \mathit{mulrdx} + \mathit{carry}; \\
103 &: \mathit{mulrax} \leftarrow & \mathit{mulx319}; \\
104 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y4}, \mathit{wsize}); \\
105 &: \mathit{r2} \leftarrow & \mathit{r2} + \mathit{mulrax}; \\
106 &: \concat{\mathit{carry}}{\mathit{r2}} \leftarrow & \dslcode{Split}(\mathit{r2}, \mathit{wsize}); \\
107 &: \mathit{mulr21} \leftarrow & \mathit{mulr21} + \mathit{mulrdx} + \mathit{carry}; \\
108 &: \mathit{mulrax} \leftarrow & \mathit{x4}; \\
109 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y0}, \mathit{wsize}); \\
110 &: \mathit{r4} \leftarrow & \mathit{r4} + \mathit{mulrax}; \\
111 &: \concat{\mathit{carry}}{\mathit{r4}} \leftarrow & \dslcode{Split}(\mathit{r4}, \mathit{wsize}); \\
112 &: \mathit{mulr41} \leftarrow & \mathit{mulr41} + \mathit{mulrdx} + \mathit{carry}; \\
113 &: \mathit{mulrax} \leftarrow & \mathit{mulx419}; \\
114 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y2}, \mathit{wsize}); \\
115 &: \mathit{r1} \leftarrow & \mathit{r1} + \mathit{mulrax}; \\
116 &: \concat{\mathit{carry}}{\mathit{r1}} \leftarrow & \dslcode{Split}(\mathit{r1}, \mathit{wsize}); \\
117 &: \mathit{mulr11} \leftarrow & \mathit{mulr11} + \mathit{mulrdx} + \mathit{carry}; \\
118 &: \mathit{mulrax} \leftarrow & \mathit{mulx419}; \\
119 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y3}, \mathit{wsize}); \\
120 &: \mathit{r2} \leftarrow & \mathit{r2} + \mathit{mulrax}; \\
121 &: \concat{\mathit{carry}}{\mathit{r2}} \leftarrow & \dslcode{Split}(\mathit{r2}, \mathit{wsize}); \\
122 &: \mathit{mulr21} \leftarrow & \mathit{mulr21} + \mathit{mulrdx} + \mathit{carry}; \\
123 &: \mathit{mulrax} \leftarrow & \mathit{mulx419}; \\
124 &: \concat{\mathit{mulrdx}}{\mathit{mulrax}} \leftarrow & \dslcode{Split}(\mathit{mulrax} \times \mathit{y4}, \mathit{wsize}); \\
125 &: \mathit{r3} \leftarrow & \mathit{r3} + \mathit{mulrax}; \\
126 &: \concat{\mathit{carry}}{\mathit{r3}} \leftarrow & \dslcode{Split}(\mathit{r3}, \mathit{wsize}); \\
127 &: \mathit{mulr31} \leftarrow & \mathit{mulr31} + \mathit{mulrdx} + \mathit{carry}; \\
128 &: \concat{\mathit{tmp}}{\mathit{r0}} \leftarrow & \dslcode{Split}(\mathit{r0}, 51); \\
129 &: \mathit{mulr01} \leftarrow & \dslcode{Pow}(\mathit{mulr01}, 13) + \mathit{tmp}; \\
130 &: \concat{\mathit{tmp}}{\mathit{r1}} \leftarrow & \dslcode{Split}(\mathit{r1}, 51); \\
131 &: \mathit{mulr11} \leftarrow & \dslcode{Pow}(\mathit{mulr11}, 13) + \mathit{tmp}; \\
132 &: \mathit{r1} \leftarrow & \mathit{r1} + \mathit{mulr01}; \\
133 &: \concat{\mathit{tmp}}{\mathit{r2}} \leftarrow & \dslcode{Split}(\mathit{r2}, 51); \\
134 &: \mathit{mulr21} \leftarrow & \dslcode{Pow}(\mathit{mulr21}, 13) + \mathit{tmp}; \\
135 &: \mathit{r2} \leftarrow & \mathit{r2} + \mathit{mulr11}; \\
136 &: \concat{\mathit{tmp}}{\mathit{r3}} \leftarrow & \dslcode{Split}(\mathit{r3}, 51); \\
137 &: \mathit{mulr31} \leftarrow & \dslcode{Pow}(\mathit{mulr31}, 13) + \mathit{tmp}; \\
138 &: \mathit{r3} \leftarrow & \mathit{r3} + \mathit{mulr21}; \\
139 &: \concat{\mathit{tmp}}{\mathit{r4}} \leftarrow & \dslcode{Split}(\mathit{r4}, 51); \\
140 &: \mathit{mulr41} \leftarrow & \dslcode{Pow}(\mathit{mulr41}, 13) + \mathit{tmp}; \\
141 &: \mathit{r4} \leftarrow & \mathit{r4} + \mathit{mulr31}; \\
142 &: \mathit{mulr41} \leftarrow & \mathit{mulr41} \times 19; \\
143 &: \mathit{r0} \leftarrow & \mathit{r0} + \mathit{mulr41}; \\
144 &: \mathit{mult} \leftarrow & \mathit{r0}; \\
145 &: \concat{\mathit{mult}}{\mathit{tmp}} \leftarrow & \dslcode{Split}(\mathit{mult}, 51); \\
146 &: \mathit{mult} \leftarrow & \mathit{mult} + \mathit{r1}; \\
147 &: \mathit{r1} \leftarrow & \mathit{mult}; \\
148 &: \concat{\mathit{mult}}{\mathit{tmp2}} \leftarrow & \dslcode{Split}(\mathit{mult}, 51); \\
149 &: \mathit{r0} \leftarrow & \mathit{tmp}; \\
150 &: \mathit{mult} \leftarrow & \mathit{mult} + \mathit{r2}; \\
151 &: \mathit{r2} \leftarrow & \mathit{mult}; \\
152 &: \concat{\mathit{mult}}{\mathit{tmp}} \leftarrow & \dslcode{Split}(\mathit{mult}, 51); \\
153 &: \mathit{r1} \leftarrow & \mathit{tmp2}; \\
154 &: \mathit{mult} \leftarrow & \mathit{mult} + \mathit{r3}; \\
155 &: \mathit{r3} \leftarrow & \mathit{mult}; \\
156 &: \concat{\mathit{mult}}{\mathit{tmp2}} \leftarrow & \dslcode{Split}(\mathit{mult}, 51); \\
157 &: \mathit{r2} \leftarrow & \mathit{tmp}; \\
158 &: \mathit{mult} \leftarrow & \mathit{mult} + \mathit{r4}; \\
159 &: \mathit{r4} \leftarrow & \mathit{mult}; \\
160 &: \concat{\mathit{mult}}{\mathit{tmp}} \leftarrow & \dslcode{Split}(\mathit{mult}, 51); \\
161 &: \mathit{r3} \leftarrow & \mathit{tmp2}; \\
162 &: \mathit{mult} \leftarrow & \mathit{mult} \times 19; \\
163 &: \mathit{r0} \leftarrow & \mathit{r0} + \mathit{mult}; \\
164 &: \mathit{r4} \leftarrow & \mathit{tmp}; \\
165 &: \mathit{z0} \leftarrow & \mathit{r0}; \\
166 &: \mathit{z1} \leftarrow & \mathit{r1}; \\
167 &: \mathit{z2} \leftarrow & \mathit{r2}; \\
168 &: \mathit{z3} \leftarrow & \mathit{r3}; \\
169 &: \mathit{z4} \leftarrow & \mathit{r4}; \\
\end{align*}
\end{multicols}
}
